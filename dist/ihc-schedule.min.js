"use strict"
function IHCSchedule(i,n){function t(){var i=h.width()
l=Math.floor(i/n.minColWidth),l<=c.length?(d=100/l,h.find(".column").css("min-width",d+"%"),h.find(".column").css("max-width",d+"%"),h.find(".dir-btn").css("display","block"),s(p)):(l=c.length+1,h.find(".column").css("min-width",100/(c.length+1)+"%"),h.find(".column").css("max-width",100/(c.length+1)+"%"),h.find(".dir-btn").removeAttr("style"),p=0,h.find(".day-columns").css("left","0"))}function s(i){var n=c.length-l+1,t=h.find(".left-btn"),s=h.find(".right-btn")
if(i<0||i>n){if(p!=i)return
i=n}p=i,h.find(".day-columns").css("left",-p*d+"%"),0==p?(t.css("display","none"),s.css("display","block")):p==n?(s.css("display","none"),t.css("display","block")):(t.css("display","block"),s.css("display","block"))}function a(i,t,s){var a=$(window).width()
t+f>=a&&(t=a-f)
var o='\n      <div class="ihc-popup-menu" data-id="'+i.attr("id")+'" style="width: '+f+"px; left: "+t+"px; top: "+s+'px">\n        <div class="edit">Edit</div>\n        <hr />'+function(){var i=""
for(var t in n.colors)n.colors.hasOwnProperty(t)&&(i+='<div class="'+t+'"><div style="background-color: '+n.colors[t]+'"></div>'+(t.charAt(0).toUpperCase()+t.slice(1))+"</div>")
return i}()+"\n      </div>\n    "
$("body").append(o),y=!0}function o(){$(".ihc-popup-menu").remove(),y=!1}function e(i){return i.attr("id").split("-")}function r(i,n){var t=""
$.each(i[0].attributes,function(){this.specified&&(t+=this.name+'="'+this.value+'"')}),i.replaceWith("<"+n+" "+t+">"+(i.val()?i.val():i.html())+"</"+n+">")}var c,d,l,v={startDay:"Monday",startTime:8,endTime:18,subDivisions:1,minColWidth:115,editable:!1,colors:{},onSave:function(i){}},u=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],f=112,n=$.extend({},v,n),h=$("#"+i),p=0,m=(n.endTime-n.startTime+1)*n.subDivisions,y=!1,b={},w=!1
!function(i){var d=u.indexOf(n.startDay)
if(c=u.slice(d).concat(u.slice(0,d)),function(){var t=[],s='\n        <div class="column time-column">\n          <div class="cell corner"></div>'+function(){for(var s,a,o,e="",r=0;r<i;r++)s=Math.floor(r/n.subDivisions)+(n.startTime-1),a=("0"+60/n.subDivisions*(r%n.subDivisions)).slice(-2),o=s%12+1+":"+a+" "+(s>=11&&s<=22?"PM":"AM"),t.push(o),e+='<div class="cell time">'+o+"</div>"
return e}()+"</div>",a='\n        <div class="day-columns">'+function(){for(var n="",s=0;s<c.length;s++)n+='<div class="column">'+function(){for(var n='<div class="cell day">'+c[s]+"</div>",a=0;a<i;a++)n+='<div id="'+c[s]+"-"+t[a].replace(" ","").replace(":","_")+'" class="cell entry"></div>'
return n}()+"</div>"
return n}()+"</div>"
h.addClass("ihc-schedule"),h.html(s+a+'\n        <div class="dir-btn left-btn">\n            <div class="arrow-left"></div>\n            <div class="arrow-head">❮</div>\n        </div>\n        <div class="dir-btn right-btn">\n            <div class="arrow-right"></div>\n            <div class="arrow-head">❯</div>\n        </div>')}(),t(),"undefined"!=typeof ResizeSensor?new ResizeSensor(h,function(){t()}):$(window).on("resize",function(){t()}),h.find(".left-btn").on("click",function(){s(p-1)}),h.find(".right-btn").on("click",function(){s(p+1)}),"undefined"!=typeof Hammer){var l=new Hammer(h[0])
l.on("swipeleft",function(){s(p+1)}),l.on("swiperight",function(){s(p-1)})}n.editable&&(h.find("div.entry").addClass("editable"),h.on("click","div.entry",function(i){if(!y){i.stopPropagation()
var n=i.pageX,t=i.pageY
a($(this),n,t)}}),$("html").on("click",function(){y&&o()}),$("body").on("click",".ihc-popup-menu > div",function(i){i.stopPropagation()
var t=$("#"+$(this).closest(".ihc-popup-menu").attr("data-id"))
if($(this).hasClass("edit"))r(t,"textarea"),w||(h.find(".corner").html('<button class="save-btn">Save</button>'),w=!0)
else{var s=e(t),a=s[0],c=s[1],d=$(this).attr("class")
b.hasOwnProperty(a)||(b[a]={}),b[a].hasOwnProperty(c)||(b[a][c]={}),b[a][c].color=d,t.css("background-color",n.colors[d])}o()}),h.on("click",".save-btn",function(){var i,t,s,a
h.find("textarea").each(function(){i=$(this).attr("id"),t=e($(this)),s=t[0],a=t[1],b.hasOwnProperty(s)||(b[s]={}),b[s].hasOwnProperty(a)||(b[s][a]={}),b[s][a].value=$(this).val(),r($(this),"div")}),h.find(".save-btn").remove(),w=!1,n.onSave(b)}))}(m),this.loadState=function(i){b=i
var t,s
for(var a in b)if(b.hasOwnProperty(a))for(var o in b[a])b[a].hasOwnProperty(o)&&(t=a+"-"+o,s=$("#"+t),s.length&&(b[a][o].hasOwnProperty("value")&&s.html(b[a][o].value),b[a][o].hasOwnProperty("color")&&s.css("background-color",n.colors[b[a][o].color])))}}