"use strict"
function IHCSchedule(i,n){function t(){var i=u.width()
r=Math.floor(i/n.minColWidth),r<=v.length?(c=100/r,u.find(".column").css("min-width",c+"%"),u.find(".column").css("max-width",c+"%"),u.find(".dir-btn").css("display","block"),s(h)):(r=v.length+1,u.find(".column").css("min-width",100/(v.length+1)+"%"),u.find(".column").css("max-width",100/(v.length+1)+"%"),u.find(".dir-btn").removeAttr("style"),h=0,u.find(".day-columns").css("left","0"))}function s(i){var n=v.length-r+1,t=u.find(".left-btn"),s=u.find(".right-btn")
if(i<0||i>n){if(h!=i)return
i=n}h=i,u.find(".day-columns").css("left",-h*c+"%"),0==h?(t.css("display","none"),s.css("display","block")):h==n?(s.css("display","none"),t.css("display","block")):(t.css("display","block"),s.css("display","block"))}function e(i,t,s){var e=$(window).width()
t+f>=e&&(t=e-f)
var o='\n      <div class="ihc-popup-menu" data-id="'+i.attr("id")+'" style="width: '+f+"px; left: "+t+"px; top: "+s+'px">\n        <div class="edit">Edit</div>\n        <hr />'+function(){var i=""
for(var t in n.colors)n.colors.hasOwnProperty(t)&&(i+='<div class="'+t+'"><div style="background-color: '+n.colors[t]+'"></div>'+(t.charAt(0).toUpperCase()+t.slice(1))+"</div>")
return i}()+"\n      </div>\n    "
$("body").append(o),m=!0}function o(){$(".ihc-popup-menu").remove(),m=!1}function a(i){return i.attr("id").split("-")}function d(i,n){var t=""
$.each(i[0].attributes,function(){this.specified&&(t+=this.name+'="'+this.value+'"')}),i.replaceWith("<"+n+" "+t+">"+(i.val()?i.val():i.html())+"</"+n+">")}var c,r,l={startTime:8,endTime:18,subDivisions:1,minColWidth:115,editable:!1,colors:{},onSave:function(i,n){}},v=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],f=112,n=$.extend({},l,n),u=$("#"+i),h=0,p=(n.endTime-n.startTime+1)*n.subDivisions,m=!1,b={},y={},w=!1
!function(i){if(function(){var t=[],s='\n        <div class="column time-column">\n          <div class="cell corner"></div>'+function(){for(var s,e,o,a="",d=0;d<i;d++)s=Math.floor(d/n.subDivisions)+(n.startTime-1),e=("0"+60/n.subDivisions*(d%n.subDivisions)).slice(-2),o=s%12+1+":"+e+" "+(s>=11&&s<=22?"PM":"AM"),t.push(o),a+='<div class="cell time">'+o+"</div>"
return a}()+"</div>",e='\n        <div class="day-columns">'+function(){for(var n="",s=0;s<v.length;s++)n+='<div class="column">'+function(){for(var n='<div class="cell day">'+v[s]+"</div>",e=0;e<i;e++)n+='<div id="'+t[e].replace(" ","").replace(":","_")+"-"+s+'" class="cell entry"></div>'
return n}()+"</div>"
return n}()+"</div>"
u.addClass("ihc-schedule"),u.html(s+e+'\n        <div class="dir-btn left-btn">\n            <div class="arrow-left"></div>\n            <div class="arrow-head">❮</div>\n        </div>\n        <div class="dir-btn right-btn">\n            <div class="arrow-right"></div>\n            <div class="arrow-head">❯</div>\n        </div>')}(),t(),"undefined"!=typeof ResizeSensor?new ResizeSensor(u,function(){t()}):$(window).on("resize",function(){t()}),u.find(".left-btn").on("click",function(){s(h-1)}),u.find(".right-btn").on("click",function(){s(h+1)}),"undefined"!=typeof Hammer){var c=new Hammer(u[0])
c.on("swipeleft",function(){s(h+1)}),c.on("swiperight",function(){s(h-1)})}n.editable&&(u.find("div.entry").addClass("editable"),u.on("click","div.entry",function(i){if(!m){i.stopPropagation()
var n=i.pageX,t=i.pageY
e($(this),n,t)}}),$("html").on("click",function(){m&&o()}),$("body").on("click",".ihc-popup-menu > div",function(i){i.stopPropagation()
var t=$("#"+$(this).closest(".ihc-popup-menu").attr("data-id"))
if($(this).hasClass("edit"))d(t,"textarea"),w||(u.find(".corner").html('<button class="save-btn">Save</button>'),w=!0)
else{var s=a(t),e=$(this).attr("class")
y.hasOwnProperty(s[0])||(y[s[0]]=[]),y[s[0]][s[1]]=e,t.css("background-color",n.colors[e])}o()}),u.on("click",".save-btn",function(){var i,t
u.find("textarea").each(function(){i=$(this).attr("id"),t=a($(this)),b.hasOwnProperty(t[0])||(b[t[0]]=[]),b[t[0]][t[1]]=$(this).val(),d($(this),"div")}),u.find(".save-btn").remove(),w=!1,n.onSave(b,y)}))}(p),this.loadState=function(i,t){b=i,y=t
for(var s in i)if(i.hasOwnProperty(s))for(var e=i[s],o=0;o<e.length;o++)if(e[o]){var a=s+"-"+o,d=$("#"+a)
d.length&&d.html(e[o])}for(var s in t)if(t.hasOwnProperty(s))for(var c=t[s],o=0;o<c.length;o++)if(c[o]){var a=s+"-"+o,d=$("#"+a)
d.length&&d.css("background-color",n.colors[c[o]])}}}