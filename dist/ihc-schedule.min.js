"use strict"
function IHCSchedule(i,n){function t(){var i=f.width()
r=Math.floor(i/n.minColWidth),r<=v.length?(c=100/r,f.find(".column").css("min-width",c+"%"),f.find(".column").css("max-width",c+"%"),f.find(".dir-btn").css("display","block"),s(h)):(r=v.length+1,f.find(".column").css("min-width",100/(v.length+1)+"%"),f.find(".column").css("max-width",100/(v.length+1)+"%"),f.find(".dir-btn").removeAttr("style"),h=0,f.find(".day-columns").css("left","0"))}function s(i){var n=v.length-r+1,t=f.find(".left-btn"),s=f.find(".right-btn")
if(i<0||i>n){if(h!=i)return
i=n}h=i,f.find(".day-columns").css("left",-h*c+"%"),0==h?(t.css("display","none"),s.css("display","block")):h==n?(s.css("display","none"),t.css("display","block")):(t.css("display","block"),s.css("display","block"))}function o(i,t,s){var o=$(window).width()
t+u>=o&&(t=o-u)
var a='\n      <div class="ihc-popup-menu" data-id="'+i.attr("id")+'" style="width: '+u+"px; left: "+t+"px; top: "+s+'px">\n        <div class="edit">Edit</div>\n        <hr />'+function(){var i=""
for(var t in n.colors)n.colors.hasOwnProperty(t)&&(i+='<div class="'+t+'"><div style="background-color: '+n.colors[t]+'"></div>'+(t.charAt(0).toUpperCase()+t.slice(1))+"</div>")
return i}()+"\n      </div>\n    "
$("body").append(a),m=!0}function a(){$(".ihc-popup-menu").remove(),m=!1}function e(i){var n=i.attr("id")
return[parseInt(n[0],10),parseInt(n[2],10)]}function d(i,n){var t=""
$.each(i[0].attributes,function(){this.specified&&(t+=this.name+'="'+this.value+'"')}),i.replaceWith("<"+n+" "+t+">"+(i.val()?i.val():i.html())+"</"+n+">")}var c,r,l={startTime:8,endTime:18,subDivisions:1,minColWidth:115,editable:!1,colors:{},onSave:function(i,n){}},v=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=112,n=$.extend({},l,n),f=$("#"+i),h=0,p=(n.endTime-n.startTime+1)*n.subDivisions,m=!1,b=[],y=[],w=!1
!function(i){!function(){var t='\n        <div class="column time-column">\n          <div class="cell corner"></div>'+function(){for(var t,s,o="",a=0;a<i;a++)t=Math.floor(a/n.subDivisions)+(n.startTime-1),s=("0"+60/n.subDivisions*(a%n.subDivisions)).slice(-2),o+='<div class="cell time">'+(t%12+1)+":"+s+" "+(t>=11&&t<=22?"PM":"AM")+"</div>"
return o}()+"</div>",s='\n        <div class="day-columns">'+function(){for(var n="",t=0;t<v.length;t++)n+='<div class="column">'+function(){for(var n='<div class="cell day">'+v[t]+"</div>",s=0;s<i;s++)n+='<div id="'+s+"-"+t+'" class="cell entry"></div>'
return n}()+"</div>"
return n}()+"</div>"
f.addClass("ihc-schedule"),f.html(t+s+'\n        <div class="dir-btn left-btn">\n            <div class="arrow-left"></div>\n            <div class="arrow-head">❮</div>\n        </div>\n        <div class="dir-btn right-btn">\n            <div class="arrow-right"></div>\n            <div class="arrow-head">❯</div>\n        </div>')}()
for(var c=0;c<i;c++)b.push([]),y.push([])
if(t(),"undefined"!=typeof ResizeSensor?new ResizeSensor(f,function(){t()}):$(window).on("resize",function(){t()}),f.find(".left-btn").on("click",function(){s(h-1)}),f.find(".right-btn").on("click",function(){s(h+1)}),"undefined"!=typeof Hammer){var r=new Hammer(f[0])
r.on("swipeleft",function(){s(h+1)}),r.on("swiperight",function(){s(h-1)})}n.editable&&(f.find("div.entry").addClass("editable"),f.on("click","div.entry",function(i){if(!m){i.stopPropagation()
var n=i.pageX,t=i.pageY
o($(this),n,t)}}),$("html").on("click",function(){m&&a()}),$("body").on("click",".ihc-popup-menu > div",function(i){i.stopPropagation()
var t=$("#"+$(this).closest(".ihc-popup-menu").attr("data-id"))
if($(this).hasClass("edit"))d(t,"textarea"),w||(f.find(".corner").html('<button class="save-btn">Save</button>'),w=!0)
else{var s=e(t),o=$(this).attr("class")
y[s[0]][s[1]]=o,t.css("background-color",n.colors[o])}a()}),f.on("click",".save-btn",function(){var i,t
f.find("textarea").each(function(){i=$(this).attr("id"),t=e($(this)),b[t[0]][t[1]]=$(this).val(),d($(this),"div")}),f.find(".save-btn").remove(),w=!1,n.onSave(b,y)}))}(p),this.loadState=function(i,t){for(var s,o,a=0;a<p;a++)for(var e=0;e<v.length;e++)i&&(s=i[a][e],s?($("#"+a+"-"+e).html(s),b[a][e]=s):b[a][e]&&(b[a][e]=void 0)),t&&(o=t[a][e],o?($("#"+a+"-"+e).css("background-color",n.colors[o]),y[a][e]=o):y[a][e]&&y[a][e])}}