"use strict"
function IHCSchedule(i,n){function t(){var i=h.width()
l=Math.floor(i/n.minColWidth),l<=r.length?(d=100/l,h.find(".column").css("min-width",d+"%"),h.find(".column").css("max-width",d+"%"),h.find(".dir-btn").css("display","block"),s(p)):(l=r.length+1,h.find(".column").css("min-width",100/(r.length+1)+"%"),h.find(".column").css("max-width",100/(r.length+1)+"%"),h.find(".dir-btn").removeAttr("style"),p=0,h.find(".day-columns").css("left","0"))}function s(i){var n=r.length-l+1,t=h.find(".left-btn"),s=h.find(".right-btn")
if(i<0||i>n){if(p!=i)return
i=n}p=i,h.find(".day-columns").css("left",-p*d+"%"),0==p?(t.css("display","none"),s.css("display","block")):p==n?(s.css("display","none"),t.css("display","block")):(t.css("display","block"),s.css("display","block"))}function o(i,t,s){var o=$(window).width()
t+f>=o&&(t=o-f)
var a='\n      <div class="ihc-popup-menu" data-id="'+i.attr("id")+'" style="width: '+f+"px; left: "+t+"px; top: "+s+'px">\n        <div class="edit">Edit</div>\n        <hr />'+function(){var i=""
for(var t in n.colors)n.colors.hasOwnProperty(t)&&(i+='<div class="'+t+'"><div style="background-color: '+n.colors[t]+'"></div>'+(t.charAt(0).toUpperCase()+t.slice(1))+"</div>")
return i}()+"\n      </div>\n    "
$("body").append(a),m=!0}function a(){$(".ihc-popup-menu").remove(),m=!1}function e(i){return i.attr("id").split("-")}function c(i,n){var t=""
$.each(i[0].attributes,function(){this.specified&&(t+=this.name+'="'+this.value+'"')}),i.replaceWith("<"+n+" "+t+">"+(i.val()?i.val():i.html())+"</"+n+">")}var r,d,l,v={startDay:"Monday",startTime:8,endTime:18,subDivisions:1,minColWidth:115,editable:!1,colors:{},onSave:function(i){},onEntryClick:null},u=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],f=112,n=$.extend({},v,n),h=$("#"+i),p=0,y=(n.endTime-n.startTime+1)*n.subDivisions,m=!1,b={},w=!1
!function(i){var d=u.indexOf(n.startDay)
if(r=u.slice(d).concat(u.slice(0,d)),function(){var t=[],s='\n        <div class="column time-column">\n          <div class="cell corner"></div>'+function(){for(var s,o,a,e="",c=0;c<i;c++)s=Math.floor(c/n.subDivisions)+(n.startTime-1),o=("0"+60/n.subDivisions*(c%n.subDivisions)).slice(-2),a=s%12+1+":"+o+" "+(s>=11&&s<=22?"PM":"AM"),t.push(a),e+='<div class="cell time">'+a+"</div>"
return e}()+"</div>",o='\n        <div class="day-columns">'+function(){for(var n="",s=0;s<r.length;s++)n+='<div class="column">'+function(){for(var n='<div class="cell day">'+r[s]+"</div>",o=0;o<i;o++)n+='<div id="'+r[s]+"-"+t[o].replace(" ","").replace(":","_")+'" class="cell entry"></div>'
return n}()+"</div>"
return n}()+"</div>"
h.addClass("ihc-schedule"),h.html(s+o+'\n        <div class="dir-btn left-btn">\n            <div class="arrow-left"></div>\n            <div class="arrow-head">❮</div>\n        </div>\n        <div class="dir-btn right-btn">\n            <div class="arrow-right"></div>\n            <div class="arrow-head">❯</div>\n        </div>')}(),t(),"undefined"!=typeof ResizeSensor?new ResizeSensor(h,function(){t()}):$(window).on("resize",function(){t()}),h.find(".left-btn").on("click",function(){s(p-1)}),h.find(".right-btn").on("click",function(){s(p+1)}),"undefined"!=typeof Hammer){var l=new Hammer(h[0])
l.on("swipeleft",function(){s(p+1)}),l.on("swiperight",function(){s(p-1)})}n.editable&&(h.find("div.entry").addClass("editable"),n.onEntryClick?h.on("click","div.entry",function(i){n.onEntryClick($(this),b,n.colors)}):(h.on("click","div.entry",function(i){if(!m){i.stopPropagation()
var n=i.pageX,t=i.pageY
o($(this),n,t)}}),$("html").on("click",function(){m&&a()}),$("body").on("click",".ihc-popup-menu > div",function(i){i.stopPropagation()
var t=$("#"+$(this).closest(".ihc-popup-menu").attr("data-id"))
if($(this).hasClass("edit"))c(t,"textarea"),w||(h.find(".corner").html('<button class="save-btn">Save</button>'),w=!0)
else{var s=e(t),o=s[0],r=s[1],d=$(this).attr("class")
b.hasOwnProperty(o)||(b[o]={}),b[o].hasOwnProperty(r)||(b[o][r]={}),b[o][r].color=d,t.css("background-color",n.colors[d])}a()}),h.on("click",".save-btn",function(){var i,t,s,o
h.find("textarea").each(function(){i=$(this).attr("id"),t=e($(this)),s=t[0],o=t[1],b.hasOwnProperty(s)||(b[s]={}),b[s].hasOwnProperty(o)||(b[s][o]={}),b[s][o].value=$(this).val(),c($(this),"div")}),h.find(".save-btn").remove(),w=!1,n.onSave(b)})))}(y),this.loadState=function(i){b=i
var t,s
for(var o in b)if(b.hasOwnProperty(o))for(var a in b[o])b[o].hasOwnProperty(a)&&(t=o+"-"+a,s=$("#"+t),s.length&&(b[o][a].hasOwnProperty("value")&&s.html(b[o][a].value),b[o][a].hasOwnProperty("color")&&s.css("background-color",n.colors[b[o][a].color])))}}