"use strict"
function IHCSchedule(i,n){function t(){var i=h.width()
l=Math.floor(i/n.minColWidth),l<=d.length?(r=100/l,h.find(".column").css("min-width",r+"%"),h.find(".column").css("max-width",r+"%"),h.find(".dir-btn").css("display","block"),s(p)):(l=d.length+1,h.find(".column").css("min-width",100/(d.length+1)+"%"),h.find(".column").css("max-width",100/(d.length+1)+"%"),h.find(".dir-btn").removeAttr("style"),p=0,h.find(".day-columns").css("left","0"))}function s(i){var n=d.length-l+1,t=h.find(".left-btn"),s=h.find(".right-btn")
if(i<0||i>n){if(p!=i)return
i=n}p=i,h.find(".day-columns").css("left",-p*r+"%"),0==p?(t.css("display","none"),s.css("display","block")):p==n?(s.css("display","none"),t.css("display","block")):(t.css("display","block"),s.css("display","block"))}function a(i,t,s){var a=$(window).width()
t+u>=a&&(t=a-u)
var e='\n      <div class="ihc-popup-menu" data-id="'+i.attr("id")+'" style="width: '+u+"px; left: "+t+"px; top: "+s+'px">\n        <div class="edit">Edit</div>\n        <hr />'+function(){var i=""
for(var t in n.colors)n.colors.hasOwnProperty(t)&&(i+='<div class="'+t+'"><div style="background-color: '+n.colors[t]+'"></div>'+(t.charAt(0).toUpperCase()+t.slice(1))+"</div>")
return i}()+"\n      </div>\n    "
$("body").append(e),y=!0}function e(){$(".ihc-popup-menu").remove(),y=!1}function o(i){return i.attr("id").split("-")}function c(i,n){var t=""
$.each(i[0].attributes,function(){this.specified&&(t+=this.name+'="'+this.value+'"')}),i.replaceWith("<"+n+" "+t+">"+(i.val()?i.val():i.html())+"</"+n+">")}var d,r,l,v={startDay:"Monday",startTime:8,endTime:18,subDivisions:1,minColWidth:115,editable:!1,colors:{},onSave:function(i,n){}},f=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=112,n=$.extend({},v,n),h=$("#"+i),p=0,m=(n.endTime-n.startTime+1)*n.subDivisions,y=!1,b={},w={},g=!1
!function(i){var r=f.indexOf(n.startDay)
if(d=f.slice(r).concat(f.slice(0,r)),function(){var t=[],s='\n        <div class="column time-column">\n          <div class="cell corner"></div>'+function(){for(var s,a,e,o="",c=0;c<i;c++)s=Math.floor(c/n.subDivisions)+(n.startTime-1),a=("0"+60/n.subDivisions*(c%n.subDivisions)).slice(-2),e=s%12+1+":"+a+" "+(s>=11&&s<=22?"PM":"AM"),t.push(e),o+='<div class="cell time">'+e+"</div>"
return o}()+"</div>",a='\n        <div class="day-columns">'+function(){for(var n="",s=0;s<d.length;s++)n+='<div class="column">'+function(){for(var n='<div class="cell day">'+d[s]+"</div>",a=0;a<i;a++)n+='<div id="'+t[a].replace(" ","").replace(":","_")+"-"+s+'" class="cell entry"></div>'
return n}()+"</div>"
return n}()+"</div>"
h.addClass("ihc-schedule"),h.html(s+a+'\n        <div class="dir-btn left-btn">\n            <div class="arrow-left"></div>\n            <div class="arrow-head">❮</div>\n        </div>\n        <div class="dir-btn right-btn">\n            <div class="arrow-right"></div>\n            <div class="arrow-head">❯</div>\n        </div>')}(),t(),"undefined"!=typeof ResizeSensor?new ResizeSensor(h,function(){t()}):$(window).on("resize",function(){t()}),h.find(".left-btn").on("click",function(){s(p-1)}),h.find(".right-btn").on("click",function(){s(p+1)}),"undefined"!=typeof Hammer){var l=new Hammer(h[0])
l.on("swipeleft",function(){s(p+1)}),l.on("swiperight",function(){s(p-1)})}n.editable&&(h.find("div.entry").addClass("editable"),h.on("click","div.entry",function(i){if(!y){i.stopPropagation()
var n=i.pageX,t=i.pageY
a($(this),n,t)}}),$("html").on("click",function(){y&&e()}),$("body").on("click",".ihc-popup-menu > div",function(i){i.stopPropagation()
var t=$("#"+$(this).closest(".ihc-popup-menu").attr("data-id"))
if($(this).hasClass("edit"))c(t,"textarea"),g||(h.find(".corner").html('<button class="save-btn">Save</button>'),g=!0)
else{var s=o(t),a=$(this).attr("class")
w.hasOwnProperty(s[0])||(w[s[0]]=[]),w[s[0]][s[1]]=a,t.css("background-color",n.colors[a])}e()}),h.on("click",".save-btn",function(){var i,t
h.find("textarea").each(function(){i=$(this).attr("id"),t=o($(this)),b.hasOwnProperty(t[0])||(b[t[0]]=[]),b[t[0]][t[1]]=$(this).val(),c($(this),"div")}),h.find(".save-btn").remove(),g=!1,n.onSave(b,w)}))}(m),this.loadState=function(i,t){b=i,w=t
for(var s in i)if(i.hasOwnProperty(s))for(var a=i[s],e=0;e<a.length;e++)if(a[e]){var o=s+"-"+e,c=$("#"+o)
c.length&&c.html(a[e])}for(var s in t)if(t.hasOwnProperty(s))for(var d=t[s],e=0;e<d.length;e++)if(d[e]){var o=s+"-"+e,c=$("#"+o)
c.length&&c.css("background-color",n.colors[d[e]])}}}